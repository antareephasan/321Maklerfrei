(this.webpackJsonprocket=this.webpackJsonprocket||[]).push([[12],{241:function(e,t,s){"use strict";var a=s(4),n=s(0),r=s(144),c=s(145),l=s(135),i=s(18),o=s(34),u=s(129),d=s(1);t.a=function(e){var t=e.formRef,s=e.callback,j=e.m_user,b=Object(n.useContext)(i.a),m=b.user,O=(b.lastname,b.setUser),x=Object(n.useState)(!1),h=Object(a.a)(x,2),p=h[0],f=h[1],v=Object(u.a)().t;return Object(d.jsx)(r.c,{innerRef:t,initialValues:{username:j?j.name:"",lastname:j?j.lastname:"",email:j?j.email:""},validationSchema:c.b().shape({username:c.c().required(v("First Name is required")),lastname:c.c().required(v("Last Name is required")),email:c.c().email().required(v("Email is required"))}),onSubmit:function(e,t){var a=e.username,n=e.lastname,r=e.email,c=t.setStatus,i=t.setSubmitting;f(!1),c(),l.d.updateUserDetails(j.id,a,r,n).then((function(e){f(!0),i(!1),m.id===j.id&&O(e.data),s&&s(e.data)}),(function(e){i(!1),e.response?c(v(e.response.data)):c(v("Some error occured.")),s&&s(null)}))},children:function(e){var s=e.errors,a=e.status,n=e.touched,c=e.isSubmitting;return Object(d.jsxs)(r.b,{children:[Object(d.jsxs)("div",{className:"flex gap-4",children:[Object(d.jsxs)(o.Label,{className:"flex-1",children:[Object(d.jsxs)("span",{children:[v("First Name"),":"]}),Object(d.jsx)(r.a,{className:"mt-1",as:o.Input,name:"username",type:"text",placeholder:v("enter first name")}),s.username&&n.username?Object(d.jsx)("div",{children:Object(d.jsx)(o.HelperText,{valid:!1,children:v(s.username)})}):null]}),Object(d.jsxs)(o.Label,{className:"flex-1",children:[Object(d.jsxs)("span",{children:[v("Last Name"),":"]}),Object(d.jsx)(r.a,{className:"mt-1",as:o.Input,name:"lastname",type:"text",placeholder:v("enter last name")}),s.lastname&&n.lastname?Object(d.jsx)("div",{children:Object(d.jsx)(o.HelperText,{valid:!1,children:v(s.lastname)})}):null]})]}),Object(d.jsxs)(o.Label,{className:"mt-4",children:[Object(d.jsx)("span",{children:"E-Mail:"}),Object(d.jsx)(r.a,{className:"mt-1",as:o.Input,name:"email",type:"email",placeholder:v("enter email")}),s.email&&n.email?Object(d.jsx)("div",{children:Object(d.jsx)(o.HelperText,{valid:!1,children:v(s.email)})}):null]}),!t&&Object(d.jsx)(o.Button,{className:"mt-6",block:!0,type:"submit",value:"submit",disabled:c,children:v("Save Details")}),a&&Object(d.jsx)(o.HelperText,{valid:!1,children:a.message}),p&&Object(d.jsx)(o.HelperText,{valid:!0,children:"Saved!"})]})}})}},253:function(e,t,s){"use strict";var a=s(4),n=s(0),r=s(34),c=s(144),l=s(145),i=s(135),o=s(129),u=s(1);t.a=function(e){var t=e.formRef,s=e.callback,d=e.m_user,j=Object(n.useState)(!1),b=Object(a.a)(j,2),m=b[0],O=b[1],x=Object(o.a)().t;return Object(u.jsx)(c.c,{innerRef:t,initialValues:{password:""},validationSchema:l.b().shape({password:l.c().min(8).matches("^.*[0-9].*$","Atleast one number required").matches("^.*[a-zA-Z].*$","Atleast one letter required").required(x("Password is required"))}),onSubmit:function(e,t){var a=e.password,n=t.setStatus,r=t.setSubmitting;O(!1),n(),i.d.updateUserPassword(d.id,a).then((function(e){O(!0),r(!1),s&&s(e.data)}),(function(e){r(!1),e.response?n(e.response.data):n("Some error occured."),s&&s(null)}))},children:function(e){var s=e.errors,a=e.status,n=e.touched,l=e.isSubmitting;return Object(u.jsxs)(c.b,{children:[Object(u.jsxs)(r.Label,{children:[Object(u.jsxs)("span",{children:[x("type new password"),":"]}),Object(u.jsx)(c.a,{className:"mt-1",as:r.Input,name:"password",type:"password",placeholder:"***************"}),s.password&&n.password?Object(u.jsx)("div",{children:Object(u.jsx)(r.HelperText,{valid:!1,children:x(s.password)})}):null]}),!t&&Object(u.jsx)(r.Button,{className:"mt-6",block:!0,type:"submit",value:"submit",disabled:l,children:x("Save Password")}),a&&Object(u.jsx)(r.HelperText,{valid:!1,children:a}),m&&Object(u.jsx)(r.HelperText,{valid:!0,children:"Saved!"})]})}})}},254:function(e,t,s){"use strict";s(0);var a=s(22),n=s(130),r=s(1);t.a=function(e){var t=e.message;return Object(r.jsxs)("div",{className:"flex flex-col items-center",children:[Object(r.jsx)(n.ForbiddenIcon,{className:"w-12 h-12 mt-8 text-purple-200","aria-hidden":"true"}),Object(r.jsx)("h1",{className:"text-6xl font-semibold text-gray-700 dark:text-gray-200",children:"Error"}),Object(r.jsxs)("p",{className:"text-gray-700 dark:text-gray-300",children:[t&&t," ",Object(r.jsx)(a.b,{className:"text-purple-600 hover:underline dark:text-purple-300",to:"/app",children:"Go back"}),"."]})]})}},457:function(e,t,s){"use strict";s.r(t);var a=s(4),n=s(0),r=s.n(n),c=s(2),l=s(46),i=s(18),o=s(19),u=s(254),d=s(137),j=s(34),b=s(130),m=s(1);function O(){return Object(m.jsx)(j.TableHeader,{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)(j.TableCell,{children:"Name"}),Object(m.jsx)(j.TableCell,{children:"Email"}),Object(m.jsx)(j.TableCell,{children:"Role"}),Object(m.jsx)(j.TableCell,{children:"Actions"})]})})}function x(e){var t=e.dataTable,s=e.onAction;return Object(m.jsx)(j.TableBody,{children:t.map((function(e,t){return Object(m.jsxs)(j.TableRow,{children:[Object(m.jsx)(j.TableCell,{children:Object(m.jsx)("div",{className:"flex items-center text-sm",children:Object(m.jsx)("div",{children:Object(m.jsx)("p",{className:"font-semibold",children:e.name})})})}),Object(m.jsx)(j.TableCell,{children:Object(m.jsx)("span",{className:"text-sm",children:e.email})}),Object(m.jsx)(j.TableCell,{children:Object(m.jsx)(j.Badge,{type:"admin"===e.role?"primary":"neutral",children:e.role})}),Object(m.jsx)(j.TableCell,{children:Object(m.jsxs)("div",{className:"flex items-center space-x-4",children:[Object(m.jsx)(j.Button,{layout:"link",size:"icon","aria-label":"Edit",onClick:function(t){t.preventDefault(),s&&s(e,"updateUser")},children:Object(m.jsx)(b.OutlinePersonIcon,{className:"w-5 h-5","aria-hidden":"true"})}),Object(m.jsx)(j.Button,{layout:"link",size:"icon","aria-label":"Edit Password",onClick:function(t){t.preventDefault(),s&&s(e,"updatePassword")},children:Object(m.jsx)(b.EditIcon,{className:"w-5 h-5","aria-hidden":"true"})}),Object(m.jsx)(j.Button,{layout:"link",size:"icon","aria-label":"Delete",onClick:function(t){t.preventDefault(),s&&s(e,"deleteUser")},children:Object(m.jsx)(b.TrashIcon,{className:"w-5 h-5","aria-hidden":"true"})})]})})]},t)}))})}function h(e){var t=e.users,s=e.resultsPerPage,a=e.totalResults,n=e.onAction,r=e.onPageChange;return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(j.TableContainer,{className:"mb-8",children:[Object(m.jsxs)(j.Table,{children:[Object(m.jsx)(O,{}),Object(m.jsx)(x,{dataTable:t,onAction:n})]}),Object(m.jsx)(j.TableFooter,{children:Object(m.jsx)(j.Pagination,{totalResults:a,resultsPerPage:s,onChange:r,label:"Table navigation"})})]})})}var p=function(e){var t=e.title,s=e.pos_text,a=e.neg_text,n=e.body,r=e.isOpen,c=e.onClose,l=e.onAction,i=e.enabled;return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(j.Modal,{isOpen:r,onClose:c,children:[Object(m.jsx)(j.ModalHeader,{children:t}),Object(m.jsx)(j.ModalBody,{children:n}),Object(m.jsxs)(j.ModalFooter,{children:[Object(m.jsx)("div",{className:"hidden sm:block",children:Object(m.jsx)(j.Button,{layout:"outline",onClick:c,children:a})}),Object(m.jsx)("div",{className:"hidden sm:block",children:Object(m.jsx)(j.Button,{onClick:l,disabled:!i,children:s})}),Object(m.jsx)("div",{className:"block w-full sm:hidden",children:Object(m.jsx)(j.Button,{block:!0,size:"large",layout:"outline",onClick:c,children:a})}),Object(m.jsx)("div",{className:"block w-full sm:hidden",children:Object(m.jsx)(j.Button,{block:!0,size:"large",onClick:l,disabled:!i,children:s})})]})]})})},f=s(131),v=s(132),w=s(144),S=s(145),C=s(135);var k=function(e){var t=e.formRef,s=e.callback;return Object(m.jsx)(w.c,{innerRef:t,initialValues:{username:"",email:"",password:"",role:"user"},validationSchema:S.b().shape({username:S.c().required("Username is required"),email:S.c().email().required("Email is required"),password:S.c().min(8).matches("^.*[0-9].*$","Atleast one number required").matches("^.*[a-zA-Z].*$","Atleast one letter required").required("Password is required"),role:S.c().required("Role is required")}),onSubmit:function(){var e=Object(v.a)(Object(f.a)().mark((function e(t,a){var n,r,c,l,i;return Object(f.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.email,c=t.password,l=t.role,i=a.setStatus,a.setSubmitting,i(),e.next=5,C.d.createUser(n,r,c,l.toLowerCase()).then((function(e){s(!0)}),(function(e){e.response?i(e.response.data):i("Some error occured."),s(!1)}));case 5:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),children:function(e){var t=e.errors,s=e.status,a=e.touched;e.isSubmitting;return Object(m.jsxs)(w.b,{children:[Object(m.jsxs)(j.Label,{children:[Object(m.jsx)("span",{children:"Name"}),Object(m.jsx)(w.a,{className:"mt-1",as:j.Input,name:"username",type:"text",placeholder:"John Doe"}),t.username&&a.username?Object(m.jsx)("div",{children:Object(m.jsx)(j.HelperText,{valid:!1,children:t.username})}):null]}),Object(m.jsxs)(j.Label,{className:"mt-4",children:[Object(m.jsx)("span",{children:"Email"}),Object(m.jsx)(w.a,{className:"mt-1",as:j.Input,name:"email",type:"email",placeholder:"john@doe.com"}),t.email&&a.email?Object(m.jsx)("div",{children:Object(m.jsx)(j.HelperText,{valid:!1,children:t.email})}):null]}),Object(m.jsxs)(j.Label,{className:"mt-4",children:[Object(m.jsx)("span",{children:"Password"}),Object(m.jsx)(w.a,{className:"mt-1",as:j.Input,name:"password",type:"password",placeholder:"***************"}),t.password&&a.password?Object(m.jsx)("div",{children:Object(m.jsx)(j.HelperText,{valid:!1,children:t.password})}):null]}),Object(m.jsxs)(j.Label,{className:"mt-4",children:[Object(m.jsx)("span",{children:"Role"}),Object(m.jsxs)(w.a,{className:"mt-1",as:j.Select,name:"role",children:[Object(m.jsx)("option",{val:"user",children:"User"}),Object(m.jsx)("option",{val:"admin",children:"Admin"})]})]}),s&&Object(m.jsx)(j.HelperText,{valid:!1,children:s.message})]})}})};function g(e){var t=e.isOpen,s=e.onClose,n=e.onAction,c=r.a.useState(!0),l=Object(a.a)(c,2),i=l[0],o=l[1],u=r.a.useRef();return Object(m.jsx)(p,{isOpen:t,title:"Create User",neg_text:"Cancel",pos_text:"Confirm",onClose:function(){o(!0),s("createUser")},onAction:function(){u.current&&u.current.validateForm().then((function(){o(!u.current.isValid),u.current.handleSubmit()}))},enabled:i,body:Object(m.jsx)(k,{formRef:u,callback:function(e){o(!0),e&&n("createUser")}})})}var N=s(241);function y(e){var t=e.isOpen,s=e.onClose,n=e.onAction,c=e.m_user,l=r.a.useState(!0),i=Object(a.a)(l,2),o=i[0],u=i[1],d=r.a.useRef();return Object(m.jsx)(p,{isOpen:t,title:"Update User",neg_text:"Cancel",pos_text:"Confirm",onClose:function(){u(!0),s("updateUser")},onAction:function(){d.current&&d.current.validateForm().then((function(){u(!d.current.isValid),d.current.handleSubmit()}))},enabled:o,body:Object(m.jsx)(N.a,{formRef:d,callback:function(e){u(!0),e&&n("updateUser")},m_user:c})})}var U=s(253);function T(e){var t=e.isOpen,s=e.onClose,n=e.onAction,c=e.m_user,l=r.a.useState(!0),i=Object(a.a)(l,2),o=i[0],u=i[1],d=r.a.useRef();return Object(m.jsx)(p,{isOpen:t,title:"Update Password",neg_text:"Cancel",pos_text:"Confirm",onClose:function(){u(!0),s("updatePassword")},onAction:function(){d.current&&d.current.validateForm().then((function(){u(!d.current.isValid),d.current.handleSubmit()}))},enabled:o,body:Object(m.jsx)(U.a,{formRef:d,callback:function(e){u(!0),e&&n("updatePassword")},m_user:c})})}function A(e){var t=e.isOpen,s=e.onClose,n=e.onAction,c=e.m_user,l=r.a.useState(null),i=Object(a.a)(l,2),o=i[0],u=i[1],d=r.a.useState(!0),b=Object(a.a)(d,2),O=b[0],x=b[1];return Object(m.jsx)(p,{isOpen:t,title:"Delete User",neg_text:"Cancel",pos_text:"Delete User",onClose:function(){x(!0),u(null),s("deleteUser")},onAction:function(){x(!1),C.d.deleteUser(c.id).then((function(){x(!0),u(null),n("deleteUser")})).catch((function(e){x(!0),e.response?u(e.response.data.message):u("Some error occured.")}))},enabled:O,body:Object(m.jsxs)("div",{children:[Object(m.jsx)("p",{children:'"Are you sure you want to delete this user?"'}),o&&Object(m.jsx)(j.HelperText,{valid:!1,children:o})]})})}var P=s(17);t.default=function(){var e=Object(n.useContext)(l.a),t=e.openSnackbar,s=e.closeSnackbar,r=Object(n.useContext)(i.a).logout,b=Object(n.useState)(!1),O=Object(a.a)(b,2),x=O[0],p=O[1],f=Object(n.useState)(!1),v=Object(a.a)(f,2),w=v[0],S=v[1],k=Object(n.useState)(!1),N=Object(a.a)(k,2),U=N[0],R=N[1],q=Object(n.useState)(!1),_=Object(a.a)(q,2),H=_[0],B=_[1],E=Object(n.useState)(!1),F=Object(a.a)(E,2),I=F[0],L=F[1],D=Object(n.useState)(null),z=Object(a.a)(D,2),V=z[0],M=z[1],$=Object(n.useState)(null),J=Object(a.a)($,2),Z=J[0],G=J[1],K=Object(n.useState)(1),Q=Object(a.a)(K,2),W=Q[0],X=Q[1],Y=Object(n.useState)(0),ee=Object(a.a)(Y,2),te=ee[0],se=ee[1],ae=Object(n.useState)(null),ne=Object(a.a)(ae,2),re=ne[0],ce=ne[1],le=Object(n.useState)(!1),ie=Object(a.a)(le,2),oe=ie[0],ue=ie[1];Object(n.useEffect)((function(){oe?t("Refresing users.."):s()}),[oe,t,s]);var de=Object(n.useCallback)((function(){return ue(!0),C.d.getUsers(W).then((function(e){return ue(!1),G(e.results),se(e.totalResults),null})).catch((function(e){return ue(!1),ce(e),null}))}),[W]);Object(n.useEffect)((function(){de().then((function(){p(!0)}))}),[de]);var je=function(e,t){switch(M(e),t){case"createUser":R(!0);break;case"updateUser":S(!0);break;case"updatePassword":L(!0);break;case"deleteUser":B(!0);break;default:M(null)}},be=function(e){switch(M(null),e){case"createUser":R(!1);break;case"updateUser":S(!1);break;case"updatePassword":L(!1);break;case"deleteUser":B(!1)}},me=function(e){switch(M(null),e){case"createUser":R(!1),de();break;case"updateUser":S(!1),de();break;case"updatePassword":L(!1);break;case"deleteUser":B(!1),de()}};if(!x)return Object(m.jsx)(o.a,{});if(re){if(!re.response)return Object(m.jsx)(u.a,{message:"Some error occured : please try again."});switch(re.response.status){case 401:return r(),Object(m.jsx)(c.a,{to:"/auth"});case 403:return Object(m.jsx)(u.a,{message:"Unauthorized : Only admin can view/update all users."});default:return Object(m.jsx)(u.a,{message:"Some error occured : please try again."})}}return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"flex flex-wrap justify-between",children:[Object(m.jsx)(d.a,{children:"All Users"}),Object(m.jsx)("div",{className:"my-6",children:Object(m.jsx)(j.Button,{onClick:function(e){e.preventDefault(),je(null,"createUser")},children:"Create User"})})]}),Object(m.jsx)(h,{users:Z,resultsPerPage:P.a.users.resultsPerPage,totalResults:te,onAction:je,onPageChange:function(e){X(e)}}),Object(m.jsx)(g,{isOpen:U,onClose:be,onAction:me}),Object(m.jsx)(y,{isOpen:w,onClose:be,onAction:me,m_user:V}),Object(m.jsx)(T,{isOpen:I,onClose:be,onAction:me,m_user:V}),Object(m.jsx)(A,{isOpen:H,onClose:be,onAction:me,m_user:V})]})}}}]);
//# sourceMappingURL=12.0fde86dd.chunk.js.map